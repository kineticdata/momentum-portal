{
  "builderVersion": "",
  "schemaVersion": "1.0",
  "version": "",
  "processOwnerEmail": "",
  "lastId": 10,
  "name": "Cat Fact Explorer Workflow",
  "notes": "",
  "connectors": [
    {
      "from": "start",
      "to": "system_integration_v1_1",
      "label": "",
      "value": "",
      "type": "Complete"
    },
    {
      "from": "system_integration_v1_1",
      "to": "system_integration_v1_1",
      "label": "",
      "value": "",
      "type": "Complete"
    },
    {
      "from": "system_integration_v1_1",
      "to": "utilities_echo_v1_2",
      "label": "",
      "value": "",
      "type": "Complete"
    },
    {
      "from": "utilities_echo_v1_2",
      "to": "utilities_echo_v1_3",
      "label": "",
      "value": "",
      "type": "Complete"
    },
    {
      "from": "utilities_echo_v1_2",
      "to": "utilities_echo_v1_3",
      "label": "",
      "value": "",
      "type": "Complete"
    },
    {
      "from": "utilities_echo_v1_3",
      "to": "system_integration_v1_4",
      "label": "",
      "value": "",
      "type": "Complete"
    },
    {
      "from": "system_integration_v1_4",
      "to": "system_integration_v1_5",
      "label": "",
      "value": "",
      "type": "Complete"
    },
    {
      "from": "system_integration_v1_5",
      "to": "utilities_echo_v1_2",
      "label": "",
      "value": "",
      "type": "Complete"
    }
  ],
  "nodes": [
    {
      "configured": true,
      "defers": false,
      "deferrable": false,
      "visible": false,
      "name": "Start",
      "messages": [],
      "dependents": {
        "task": [
          {
            "label": "",
            "type": "Complete",
            "value": "",
            "content": "system_integration_v1_1"
          }
        ]
      },
      "id": "start",
      "position": {
        "x": 10,
        "y": 10
      },
      "version": 1,
      "parameters": [],
      "definitionId": "system_start_v1"
    },
    {
      "configured": true,
      "defers": false,
      "deferrable": false,
      "visible": true,
      "name": "Get Cat Fact 1",
      "messages": [],
      "dependents": {
        "task": [
          {
            "label": "",
            "type": "Complete",
            "value": "",
            "content": "system_integration_v1_1"
          },
          {
            "label": "",
            "type": "Complete",
            "value": "",
            "content": "utilities_echo_v1_2"
          }
        ]
      },
      "id": "system_integration_v1_1",
      "position": {
        "x": 200,
        "y": 120
      },
      "version": 1,
      "parameters": [
        {
          "dependsOnId": "",
          "dependsOnValue": "",
          "description": "Connection ID",
          "id": "connection",
          "label": "Connection ID",
          "menu": "",
          "value": "a7f3c891-2b4e-4d19-9c3a-8f1e5a6d7b2c",
          "required": true
        },
        {
          "dependsOnId": "",
          "dependsOnValue": "",
          "description": "Operation ID",
          "id": "operation",
          "label": "Operation ID",
          "menu": "",
          "value": "9d2e4f1a-8c3b-4e5f-a6d7-1b9c8e7f6a5d",
          "required": true
        }
      ],
      "definitionId": "system_integration_v1"
    },
    {
      "configured": true,
      "defers": false,
      "deferrable": false,
      "visible": true,
      "name": "Format Cat Facts",
      "messages": [],
      "dependents": {
        "task": [
          {
            "label": "",
            "type": "Complete",
            "value": "",
            "content": "utilities_echo_v1_3"
          },
          {
            "label": "",
            "type": "Complete",
            "value": "",
            "content": "utilities_echo_v1_3"
          }
        ]
      },
      "id": "utilities_echo_v1_2",
      "position": {
        "x": 198,
        "y": 443
      },
      "version": 1,
      "parameters": [
        {
          "dependsOnId": "",
          "dependsOnValue": "",
          "description": "",
          "id": "input",
          "label": "Input",
          "menu": "",
          "value": "<%=\n  # Get user data from first echo node\n  userData = JSON.parse(@results['Get User Data']['output'])\n  userName = userData['userName']\n  requestedCount = userData['numberOfFacts']\n  \n  # Collect all cat facts based on requested number\n  allFacts = []\n  totalCharacters = 0\n  \n  (1..requestedCount).each do |i|\n    nodeName = \"Get Cat Fact #{i}\"\n    fact = @results[nodeName]['Cat Fact']\n    length = @results[nodeName]['Fact Length'].to_i\n    \n    allFacts << {\n      'number' => i,\n      'fact' => fact,\n      'length' => length\n    }\n    \n    totalCharacters += length\n  end\n  \n  # Build formatted message\n  message = \"ðŸ± Hello #{userName}! Here are your #{requestedCount} cat fact\"\n  message += requestedCount > 1 ? \"s\" : \"\"\n  message += \":\\n\\n\"\n  \n  allFacts.each do |factData|\n    message += \"#{factData['number']}. #{factData['fact']}\\n\"\n    message += \"   (#{factData['length']} characters)\\n\\n\"\n  end\n  \n  message += \"ðŸ“Š Statistics:\\n\"\n  message += \"Total facts: #{requestedCount}\\n\"\n  message += \"Total characters: #{totalCharacters}\\n\"\n  message += \"Average length: #{(totalCharacters.to_f / requestedCount).round(1)} characters\\n\"\n  \n  # Return as JSON for easy access\n  {\n    'userName' => userName,\n    'requestedCount' => requestedCount,\n    'facts' => allFacts,\n    'totalCharacters' => totalCharacters,\n    'averageLength' => (totalCharacters.to_f / requestedCount).round(1),\n    'formattedMessage' => message\n  }.to_json\n%>",
          "required": true
        }
      ],
      "definitionId": "utilities_echo_v1"
    },
    {
      "configured": true,
      "defers": false,
      "deferrable": false,
      "visible": true,
      "name": "Final Output",
      "messages": [],
      "dependents": {
        "task": [
          {
            "label": "",
            "type": "Complete",
            "value": "",
            "content": "system_integration_v1_4"
          }
        ]
      },
      "id": "utilities_echo_v1_3",
      "position": {
        "x": 200,
        "y": 750
      },
      "version": 1,
      "parameters": [
        {
          "dependsOnId": "",
          "dependsOnValue": "",
          "description": "",
          "id": "input",
          "label": "Input",
          "menu": "",
          "value": "<%=\n  # Parse the formatted data\n  result = JSON.parse(@results['Format Cat Facts']['output'])\n  \n  # You could send this via email, update the form, log it, etc.\n  # For now, we'll just output the formatted message\n  result['formattedMessage']\n%>",
          "required": true
        }
      ],
      "definitionId": "utilities_echo_v1"
    },
    {
      "configured": true,
      "defers": false,
      "deferrable": false,
      "visible": true,
      "name": "Get Cat Fact 4",
      "messages": [],
      "dependents": {
        "task": [
          {
            "label": "",
            "type": "Complete",
            "value": "",
            "content": "system_integration_v1_5"
          }
        ]
      },
      "id": "system_integration_v1_4",
      "position": {
        "x": 352,
        "y": 316
      },
      "version": 1,
      "parameters": [
        {
          "dependsOnId": "",
          "dependsOnValue": "",
          "description": "Connection ID",
          "id": "connection",
          "label": "Connection ID",
          "menu": "",
          "value": "a7f3c891-2b4e-4d19-9c3a-8f1e5a6d7b2c",
          "required": true
        },
        {
          "dependsOnId": "",
          "dependsOnValue": "",
          "description": "Operation ID",
          "id": "operation",
          "label": "Operation ID",
          "menu": "",
          "value": "9d2e4f1a-8c3b-4e5f-a6d7-1b9c8e7f6a5d",
          "required": true
        }
      ],
      "definitionId": "system_integration_v1"
    },
    {
      "configured": true,
      "defers": false,
      "deferrable": false,
      "visible": true,
      "name": "Get Cat Fact 5",
      "messages": [],
      "dependents": {
        "task": [
          {
            "label": "",
            "type": "Complete",
            "value": "",
            "content": "utilities_echo_v1_2"
          }
        ]
      },
      "id": "system_integration_v1_5",
      "position": {
        "x": 5,
        "y": 318
      },
      "version": 1,
      "parameters": [
        {
          "dependsOnId": "",
          "dependsOnValue": "",
          "description": "Connection ID",
          "id": "connection",
          "label": "Connection ID",
          "menu": "",
          "value": "a7f3c891-2b4e-4d19-9c3a-8f1e5a6d7b2c",
          "required": true
        },
        {
          "dependsOnId": "",
          "dependsOnValue": "",
          "description": "Operation ID",
          "id": "operation",
          "label": "Operation ID",
          "menu": "",
          "value": "9d2e4f1a-8c3b-4e5f-a6d7-1b9c8e7f6a5d",
          "required": true
        }
      ],
      "definitionId": "system_integration_v1"
    }
  ]
}